# Docker Compose for Mountebank - External API Mocking
# Start with: just mocks-start
# UI: http://localhost:2525

services:
  mountebank:
    image: bbyars/mountebank:2.9.1
    container_name: vibespro-mountebank
    restart: unless-stopped
    command: ["mb", "--configfile", "/imposters/imposters.ejs", "--allowInjection"]
    ports:
      - "${MOUNTEBANK_PORT:-2525}:2525" # Admin API
      - "${MOCK_LLM_PORT:-3001}:3001" # LLM mock endpoint
      - "${MOCK_AUTH_PORT:-3002}:3002" # Auth mock endpoint
      - "${MOCK_PAYMENT_PORT:-3003}:3003" # Payment mock endpoint
    volumes:
      - ../tests/mocks/imposters:/imposters:ro
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:2525/"]
      interval: 10s
      timeout: 5s
      retries: 3
